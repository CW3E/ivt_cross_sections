"""
Filename:    cw3ecmaps.py
Author:      Deanna Nash, dnash@ucsd.edu
Description: Functions for cmaps from the CW3E website adapted from from https://github.com/samwisehawkins/nclcmaps
"""

import numpy as np
import matplotlib.colors as mcolors
from matplotlib.colors import ListedColormap
from matplotlib.ticker import FuncFormatter

__all__ = ['cw3ecmaps']


cw3e_cmaps =    {
                "ivt" :{ 
                        "colors":[[255, 255, 3],
                                [255, 229, 3],
                                [255, 201, 2],
                                [255, 175, 2],
                                [255, 131, 1],
                                [255, 79, 1], 
                                [255, 24, 1],  
                                [235, 1, 7],  
                                [185, 0, 55], 
                                [134, 0, 99],
                                [86, 0, 137]],
                        "bounds":[250, 300, 400, 500, 600, 700, 800, 1000, 1200, 1400, 1600, 5000],
                        "ticks":[250, 300, 400, 500, 600, 700, 800, 1000, 1200, 1400, 1600],
                        "label": "IVT (kg m$^{-1}$ s$^{-1}$)",
                        },

                "iwv" : { 
                        "colors":[[5, 0, 206], 
                                [8, 25, 255], 
                                [9, 113, 255], 
                                [10, 196, 255],
                                [11, 249, 237],
                                [6, 226, 160], 
                                [3, 201, 81], 
                                [9, 184, 6], 
                                [97, 208, 3],  
                                [177, 232, 2], 
                                [255, 255, 3], 
                                [255, 225, 3], 
                                [255, 197, 2], 
                                [255, 166, 2], 
                                [255, 112, 1], 
                                [255, 56, 1], 
                                [255, 1, 0], 
                                [209, 0, 33], 
                                [155, 0, 81], 
                                [100, 0, 126], 
                                [128, 59, 167]],
                        "bounds":[20, 22, 24, 26, 28, 30, 32, 34, 36, 38, 40, 42, 44, 46, 48, 50, 52, 54, 56, 58, 60, 200],
                        "ticks":[20, 24, 28, 32, 36, 40, 44, 48, 52, 56, 60],
                        "label": "IVT (kg m$^{-1}$ s$^{-1}$)"
                        },
                
                "ivt_probability":{
                                "colors": [[10, 180, 255], # blue
                                        [12, 253, 248], # cyan
                                        [7, 228, 170], # green 1
                                        [3, 203, 87], # green 2
                                        [6, 182, 6], # green 3
                                        [95, 208, 3], # green 4
                                        [176, 231, 2], # green-yellow
                                        [255, 255, 3], # yellow
                                        [255, 225, 3], # yellow-orange
                                        [255, 199, 2], # orange 1
                                        [255, 170, 2], # orange 2
                                        [255, 115, 1], # orange 3
                                        [255, 57, 1], # red 1
                                        [255, 1, 0], # red 2
                                        [205, 0, 37], # red 3
                                        [150, 0, 86], # maroon
                                        [91, 0, 133]], # purple
                                "bounds":[0., 0.25, 0.3, 0.35, 0.4, 0.45, 0.5, 0.55, 0.6, 0.65, 0.7, 0.75, 0.8, 0.85, 0.9, 0.95, 1., 1.05],
                                "ticks":[0.25, 0.3, 0.4, 0.5, 0.6, 0.7, 0.8, 0.9, 1.],
                                "label":'Probability of IVT $\geq$ {0} kg m$^{-1}$ s$^{-1}$',
                                },

                "ivt_vector":{
                        "colors":[[255., 255., 255.], #0.0-0.1
                                [9., 156., 255.], #0.1-0.2
                                [8., 235., 191.], #0.2-0.3
                                [2., 186., 24.], #0.3-0.4
                                [155., 225., 2.], #0.4-0.5
                                [255, 233, 3], #0.5-0.6
                                [255, 175, 2], #0.6-0.7
                                [255, 69, 1], #0.7-0.8
                                [215, 0, 28], #0.8-0.9
                                [102, 0, 125]], #0.9-1.0,
                        "bounds":[0., 0.1, 0.2, 0.3, 0.4, 0.5, 0.6, 0.7, 0.8, 0.9, 1.],
                        "ticks":[0., 0.2, 0.4, 0.6, 0.8, 1.],
                        "label":'Probability of IVT $\geq$ {0} kg m$^{-1}$ s$^{-1}$',
                        },

                "jay_qpf":{
                        "colors":[[10, 193, 255],
                                [156, 47, 206],
                                [206, 33, 33],
                                [140, 67, 0],
                                [255, 128, 1],
                                [140, 101, 1],
                                [255, 187, 7],
                                [255, 223, 140],
                                [255, 131, 173]],
                        "bounds":[1, 2, 3, 4, 5, 7, 10, 15, 20],
                        "ticks":[1, 2, 3, 4, 5, 7, 10, 15, 20],
                        "label": 'QPF (in.)',
                        },
                
                "brian_qpf":{
                        "colors":[[154, 219, 165],
                                [106, 198, 165],
                                [83, 174, 164],
                                [72, 148, 160],
                                [63, 123, 155],
                                [60, 97, 150],
                                [63, 68, 133],
                                [56, 46, 91],
                                [40, 25, 51]],
                        "bounds":[1, 2, 3, 4, 5, 7, 10, 15, 20],
                        "ticks":[1, 2, 3, 4, 5, 7, 10, 15, 20],
                        "label":'QPF (in.)',
                        },
                
                "test_terrain":{
                        "colors":[[255, 255, 255],
                                [156, 47, 206],
                                [206, 33, 33],
                                [140, 67, 0],
                                [255, 128, 1],
                                [140, 101, 1],
                                [255, 187, 7],
                                [255, 223, 140],
                                [255, 131, 173]],
                        "bounds":[0., 250., 500., 1000., 1500., 2000., 2500., 3000., 3500.],
                        "ticks":[0., 250., 500., 1000., 1500., 2000., 2500., 3000., 3500.],
                        "label":'elevation (m)',
                        },

                "land_sea":{
                        "colors":[[38, 63, 120],
                                [255, 255, 255]],
                        "bounds":[0., 1.],
                        "ticks": [0, 1],
                        "label":None,
                        },

                "ivt_duration":{
                        "colors": [[255, 174, 0], # orange 250
                                [236, 0, 7], # red 500
                                [86, 0, 137], # purple 750
                                [77, 77, 77]], # grey 1000,
                        "bounds":[0, 250, 500, 750, 1000],
                        "ticks":[250, 500, 750, 1000],
                        "label":'IVT $\geq$ threshold',
                        },

                "ivt_magnitude":{
                        "colors":[[10, 180, 255], # blue
                                [12, 253, 248], # cyan
                                [7, 228, 170], # green 1
                                [3, 203, 87], # green 2
                                [6, 182, 6], # green 3
                                [95, 208, 3], # green 4
                                [176, 231, 2], # green-yellow
                                [255, 255, 3], # yellow
                                [255, 225, 3], # yellow-orange
                                [255, 199, 2], # orange 1
                                [255, 170, 2], # orange 2
                                [255, 115, 1], # orange 3
                                [255, 57, 1], # red 1
                                [255, 1, 0], # red 2
                                [205, 0, 37], # red 3
                                [150, 0, 86], # maroon
                                [91, 0, 133]], # purple,
                        "bounds":[0., 250, 300, 350, 400, 450, 500, 550, 600, 650, 700, 750, 800, 850, 900, 950, 1000, 1050],
                        "ticks":[250, 350, 450, 550, 650, 750, 850, 950],
                        "label":'Ensemble Mean IVT (kg m$^{-1}$ s$^{-1}$)',
                        },

                "arscale":{
                        "colors": [[10, 193, 255], # blue
                                [4, 255, 3], # green
                                [255, 255, 3], # yellow
                                [255, 166, 2], # orange
                                [255, 1, 0]], # red,
                        "bounds":[1, 2, 3, 4, 5],
                        "ticks":[1, 2, 3, 4, 5],
                        "label": 'AR Scale',
                        },

                "ivt_intwest":{
                        "colors":[[12, 255, 255], # 100-150
                                [16, 185, 6], # 150-200
                                [140, 220, 2], # 200-250
                                [255, 255, 3], # 250-300
                                [255, 229, 3], # 300-400
                                [255, 201, 2], # 400-500
                                [255, 175, 2], # 500-600
                                [255, 131, 1], # 600-700
                                [255, 79, 1],  # 700-800
                                [255, 24, 1],  # 800-1000
                                [235, 1, 7],   # 1000-1200
                                [185, 0, 55],  # 1200-1400
                                [134, 0, 99], # 1400-1600
                                [86, 0, 137]],   # 1600+,
                        "bounds":[100, 150, 200, 250, 300, 400, 500, 600, 700, 800, 1000, 1200, 1400, 1600, 5000],
                        "ticks":[100, 150, 200, 250, 300, 400, 500, 600, 700, 800, 1000, 1200, 1400, 1600],
                        "label":'IVT (kg m$^{-1}$ s$^{-1}$)',
                        },

                "iwv_intwest":{
                        "colors":[[5, 0, 206], # 10
                                [8, 25, 255], 
                                [9, 113, 255], 
                                [10, 196, 255],
                                [11, 249, 237],
                                [6, 226, 160],
                                [3, 201, 81],
                                [9, 184, 6], 
                                [97, 208, 3], 
                                [177, 232, 2],
                                [255, 255, 3],
                                [255, 225, 3],
                                [255, 197, 2],
                                [255, 166, 2],
                                [255, 112, 1],
                                [255, 56, 1],
                                [255, 1, 0],  
                                [209, 0, 33], 
                                [155, 0, 81], 
                                [100, 0, 126],
                                [128, 59, 167]] ,
                        "bounds":[10, 12, 14, 16, 18, 20, 22, 24, 26, 28, 30, 32, 34, 36, 38, 40, 42, 44, 46, 48, 50, 200],
                        "ticks":[10, 14, 18, 22, 26, 30, 34, 38, 42, 46, 50],
                        "label":'IWV (mm)',
                        },

                "wind_speed_250":{
                        "colors": [[5, 0, 206], # 20-22
                                [8, 25, 255], # 22-24
                                [10, 196, 255], # 26-28
                                [11, 249, 237], # 28-30
                                [6, 226, 160], # 30-32
                                [9, 184, 6], # 34-36
                                [97, 208, 3],  # 36-38
                                [255, 255, 3], # 40-42
                                [255, 197, 2], # 44-46
                                [255, 166, 2], # 46-48
                                [255, 112, 1], # 48-50
                                [255, 1, 0], # 52-54
                                [209, 0, 33], # 54-56
                                [155, 0, 81], # 56-58
                                [122,0, 110], # 58-60
                                [100, 0, 126]],
                        "bounds":[70, 75, 80, 85, 90, 95, 100, 105, 110, 120, 125, 130, 135, 140, 145, 150, 200],
                        "ticks":[70, 75, 80, 85, 90, 95, 100, 105, 110, 120, 125, 130, 135, 140, 145, 150],
                        "label":'Wind Speed (knots)',
                        },

                "absolute_vorticity_500":{
                        "colors":[[5, 0, 206], # 20-22
                                [8, 25, 255], # 22-24
                                [10, 196, 255], # 26-28
                                [11, 249, 237], # 28-30
                                [6, 226, 160], # 30-32
                                [9, 184, 6], # 34-36
                                [97, 208, 3],  # 36-38
                                [255, 255, 3], # 40-42
                                [255, 197, 2], # 44-46
                                [255, 166, 2], # 46-48
                                [255, 112, 1], # 48-50
                                [255, 1, 0], # 52-54
                                [209, 0, 33], # 54-56
                                [155, 0, 81], # 56-58
                                [122,0, 110], # 58-60
                                [100, 0, 126]],
                        "bounds":[10, 12, 14, 16, 18, 20, 22, 24, 26, 28, 30, 32, 34, 36, 38, 40, 100],
                        "ticks":[10, 12, 14, 16, 18, 20, 22, 24, 26, 28, 30, 32, 34, 36, 38, 40],
                        "label":'Absolute Vorticity 500-hPa (x10$^{{-5}}$ s $^{{-1}}$)',
                        },

                "temperature_850":{
                        "colors":[[228,215,236],
                                [190,154,208],
                                [155,103,185],
                                [122,48,162],
                                [93,8,143],
                                [1,27,205],
                                [0,47,255],
                                [0,123,255],
                                [0,195,255],
                                [0,249,237],
                                [33,189,5],
                                [118,213,2],
                                [178,232,0],
                                [255,253,0],
                                [255,207,0],
                                [255,177,2],
                                [255,133,1],
                                [255,77,0],
                                [210,0,32],
                                [182,0,57],
                                [149,0,86]],
                        "bounds":[-25,-22.5,-20,-17.5,-15,-12.5,-10,-7.5,-5,-2.5,0,2.5,5,7.5,10,12.5,15,17.5,20,22.5,25,50],
                        "ticks":[-25,-20,-15,-10,-5,0,5,10,15,20,25],
                        "label":"Temperature 850-hPa ($^{{o}}$C)",
                        },
                
                "total_precipitation_mm":{
                        "colors":[[215,216,255],
                                [185,185,255],
                                [123,123,255],
                                [25,36,255],
                                [0,31,208],
                                [0,71,160],
                                [0,107,112],
                                [5,144,61],
                                [15,180,7],
                                [56,196,3],
                                [111,212,3],
                                [164,228,0],
                                [215,242,1],
                                [255,246,0],
                                [255,196,1],
                                [255,144,1],
                                [255,91,0],
                                [255,37,1],
                                [248,0,0],
                                [216,0,27],
                                [189,0,51],
                                [163,0,74],
                                [142,0,92],
                                [122,0,110],
                                [94,6,133],
                                [162,112,189]],
                        "bounds":[0.1, 1, 2.5, 5, 7.5, 10, 12, 15, 20, 25, 30, 35, 40, 45, 50, 60, 70, 80, 90, 100, 125, 150, 175, 200, 225, 250, 500],
                        "ticks":[0.1, 1, 2.5, 5, 7.5, 10, 12, 15, 20, 25, 30, 35, 40, 45, 50, 60, 70, 80, 90, 100, 125, 150, 175, 200, 225, 250],
                        "label":"Total precipitation (mm)",
                        },
                "total_precipitation_in":{
                        "colors":[[215,216,255],
                                [185,185,255],
                                [123,123,255],
                                [25,36,255],
                                [0,31,208],
                                [0,71,160],
                                [0,107,112],
                                [5,144,61],
                                [15,180,7],
                                [56,196,3],
                                [111,212,3],
                                [164,228,0],
                                [215,242,1],
                                [255,246,0],
                                [255,196,1],
                                [255,144,1],
                                [255,91,0],
                                [255,37,1],
                                [248,0,0],
                                [216,0,27],
                                [189,0,51],
                                [163,0,74],
                                [142,0,92],
                                [122,0,110],
                                [94,6,133],
                                [162,112,189]],
                        "bounds":[0.004, 0.039, 0.098, 0.197, 0.295, 0.394, 0.472, 0.591, 0.787, 0.984, 1.181, 1.378, 1.575, 1.772, 1.969, 2.362, 2.756, 3.150, 3.543, 3.937, 4.921, 5.906, 6.890, 7.874, 8.858, 9.843, 20.49],
                        "ticks":[0.004, 0.1, 0.3, 0.5, 0.8, 1.2, 1.6, 2, 3, 4, 7, 10],
                        "label":"Total precipitation (in)",
                        },
                

                "tivt":{
                        "colors":[[250, 247, 3], # 2-4
                                [251, 211, 2], # 4-6
                                [252, 137, 1], # 6-8
                                [252, 64, 1], # 8-10
                                [204, 0, 37], # 10-12
                                [155, 0, 63], # 12-14
                                [63, 63, 63], # 14-16
                                [115, 115, 115], # 16-18
                                [201, 201, 201]], # 18-20,
                        "bounds":[2, 4, 6, 8, 10, 12, 14, 16, 18, 40],
                        "ticks":[2, 4, 6, 8, 10, 12, 14, 16, 18],
                        "label":'time integrated IVT (10$^{7}$ m$^{-1}$)',
                        },
                
                 "wvflux":{
                        "colors":[[255, 255, 51], # 0.025-0.05
                                [255, 234, 51], # 0.05-0.075
                                [255, 211, 51], # 0.075-0.1
                                [255, 189, 50], # 0.1-0.15
                                [255, 155, 51], # 0.15-0.2
                                [255, 115, 51], # 0.2-0.25
                                [255, 75, 51], # 0.25-0.3
                                [239, 51, 63], # 0.3-0.35
                                [214, 51, 83], # 0.35-0.4
                                [181, 51, 110], # 0.4-0.45
                                [161, 51, 127], # 0.45-0.5
                                [140, 51, 143], # 0.5+
                                 ],
                        "bounds":[0.025, 0.05, 0.075, 0.1, 0.15, 0.2, 0.25, 0.3, 0.35, 0.4, 0.45, 0.5, 1.],
                        "ticks":[0.025, 0.05, 0.075, 0.1, 0.15, 0.2, 0.25, 0.3, 0.35, 0.4, 0.45, 0.5],
                        "label":'WV Flux (m s$^{-1}$)',
                        },
    


                }
                  
def cmap(cbarname):
        data = np.array(cw3e_cmaps[cbarname]["colors"])
        data = data / np.max(data)
        cmap = ListedColormap(data, name=cbarname)
        bnds = cw3e_cmaps[cbarname]["bounds"]
        norm = mcolors.BoundaryNorm(bnds, cmap.N)
        cbarticks = cw3e_cmaps[cbarname]["ticks"]
        cbarlbl = cw3e_cmaps[cbarname]["label"]
        return cmap, norm, bnds, cbarticks, cbarlbl


